function u(e,n){let{appName:t,loadingTheme:o,customTheme:s}=n,i=s||(o==="gradient"?"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);":"background: #2c3e50;");return `/**
 * AppBootstrap.js - Generated by app-bootstrap-lib
 * Created: ${new Date().toISOString()}
 */

(function() {
  'use strict';

  // Asset manifest
  window.ASSET_MANIFEST = ${JSON.stringify(e,null,2)};

  // Loading state
  window.APP_BOOTSTRAP_LOADING_STATE = {
    isLoaded: false,
    isLoading: true,
    progress: 0,
    currentChunk: '',
    loadedChunks: [],
    totalChunks: ${e.loadingSequence.js.length},
    error: null,
    startTime: Date.now()
  };

  // Event emitter
  window.APP_BOOTSTRAP_EVENTS = {
    listeners: {},
    on: function(event, callback) {
      if (!this.listeners[event]) this.listeners[event] = [];
      this.listeners[event].push(callback);
    },
    emit: function(event, data) {
      if (this.listeners[event]) {
        this.listeners[event].forEach(cb => cb(data));
      }
    }
  };

  // Loading screen
  function createLoadingScreen() {
    const loadingHTML = \`
      <div id="loading-screen" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        ${i}
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        z-index: 9999;
      ">
        <div style="
          width: 40px;
          height: 40px;
          border: 4px solid rgba(255, 255, 255, 0.3);
          border-top: 4px solid white;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin-bottom: 20px;
        "></div>
        <p id="loading-text">Loading ${t}...</p>
        <div id="loading-progress" style="
          width: 200px;
          height: 4px;
          background: rgba(255, 255, 255, 0.3);
          border-radius: 2px;
          margin-top: 10px;
          overflow: hidden;
        ">
          <div id="progress-bar" style="
            height: 100%;
            background: white;
            width: 0%;
            transition: width 0.3s ease;
          "></div>
        </div>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      </div>
    \`;

    document.body.insertAdjacentHTML('afterbegin', loadingHTML);
  }

  // Load assets
  async function loadAssets() {
    const { loadingSequence } = window.ASSET_MANIFEST;
    const totalChunks = loadingSequence.js.length + loadingSequence.css.length;
    let loadedChunks = 0;

    // Load CSS first
    for (const cssFile of loadingSequence.css) {
      try {
        await loadCSS(window.ASSET_MANIFEST.css[cssFile]);
        loadedChunks++;
        updateProgress(loadedChunks, totalChunks);
      } catch (error) {
        console.error('Failed to load CSS:', cssFile, error);
      }
    }

    // Load JS
    for (const jsFile of loadingSequence.js) {
      try {
        await loadJS(window.ASSET_MANIFEST.js[jsFile]);
        loadedChunks++;
        updateProgress(loadedChunks, totalChunks);
      } catch (error) {
        console.error('Failed to load JS:', jsFile, error);
      }
    }

    // Complete
    window.APP_BOOTSTRAP_LOADING_STATE.isLoaded = true;
    window.APP_BOOTSTRAP_LOADING_STATE.isLoading = false;
    window.APP_BOOTSTRAP_READY = true;

    window.APP_BOOTSTRAP_EVENTS.emit('loading:complete');
    hideLoadingScreen();
  }

  function loadCSS(href) {
    return new Promise((resolve, reject) => {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = href;
      link.onload = () => resolve();
      link.onerror = () => reject(new Error('CSS load failed: ' + href));
      document.head.appendChild(link);
    });
  }

  function loadJS(src) {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = src;
      script.type = 'module'; // Load as ES module
      script.onload = () => resolve();
      script.onerror = () => reject(new Error('JS load failed: ' + src));
      document.head.appendChild(script);
    });
  }

  function updateProgress(loaded, total) {
    const progress = Math.round((loaded / total) * 100);
    window.APP_BOOTSTRAP_LOADING_STATE.progress = progress;

    const progressBar = document.getElementById('progress-bar');
    if (progressBar) {
      progressBar.style.width = progress + '%';
    }

    window.APP_BOOTSTRAP_EVENTS.emit('loading:progress', { progress });
  }

  function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loading-screen');
    if (loadingScreen) {
      loadingScreen.style.display = 'none';
    }
  }

  // Initialize
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      createLoadingScreen();
      loadAssets();
    });
  } else {
    createLoadingScreen();
    loadAssets();
  }
})();
`}var M={vendor:1,main:2,app:3,chunk:4};function B(e={}){return {vendor:["react","react-dom"],...e}}function L(e,n,t=""){let o={},s={},i=0;for(let[a,l]of Object.entries(e)){let d=l,c=t?`${t}/${a}`:`/${a}`;a.endsWith(".js")?(o[a]=c,i+=d.code?.length||0):a.endsWith(".css")&&(s[a]=c,i+=d.source?.length||0);}let r={js:Object.keys(o).sort((a,l)=>{let d=n[a]||999,c=n[l]||999;return d-c}),css:Object.keys(s)};return {js:o,css:s,loadingSequence:r,totalOriginalSize:i,buildInfo:{timestamp:Date.now(),version:"1.2.0",appName:"PWA App",compressionEnabled:false,chunksGenerated:Object.keys(o).length,plugin:"pwa-bootstrap-kit"}}}function j(e,n){let t=`<script src="/${n.bootstrapFileName}"><\/script>`,o=e;return o=o.replace(/<script type="module" src="\/src\/main\.tsx"><\/script>/g,""),o=o.replace(/<!-- Main Application Entry Point.*?-->/g,""),o=o.replace(/<!-- Development-specific scripts -->[\s\S]*?<\/script>/g,""),o=o.replace(/<!-- Asset Manifest.*?-->\s*<script src="\/asset-manifest\.js"><\/script>/g,""),o.includes("</head>")?o=o.replace("</head>",`  ${t}
</head>`):o=t+`
`+o,o}function f(e={}){let n,t={enableGzip:false,debugMode:false,appName:"Application",loadingTheme:"gradient",customTheme:"",customChunks:{},chunkPriorities:{},assetPrefix:"",bootstrapFileName:"AppBootstrap.js",...e},o={...M,...t.chunkPriorities};return {name:"app-bootstrap-lib",config(s){s.build||(s.build={}),s.build.cssCodeSplit=true,s.build.rollupOptions||(s.build.rollupOptions={}),s.build.rollupOptions.output||(s.build.rollupOptions.output={});let i=s.build.rollupOptions.output;i.entryFileNames="[name].js",i.chunkFileNames="[name].js",i.assetFileNames=a=>{if(!a.name)return "[name].[ext]";let l=a.name.split("."),d=l[l.length-1];return /\.(css)$/.test(a.name)?`assets/[name].${d}`:"[name].[ext]"};let r=B(t.customChunks);return i.manualChunks=r,t.debugMode&&(console.log("[app-bootstrap-lib] App name:",t.appName),console.log("[app-bootstrap-lib] Theme:",t.loadingTheme)),s},transformIndexHtml(s){console.log("[app-bootstrap-lib] \u{1F50D} Transforming index.html..."),console.log("[app-bootstrap-lib] \u{1F4C4} HTML length:",s.length);let i=j(s,t);return console.log("[app-bootstrap-lib] \u2705 HTML transformation complete"),console.log("[app-bootstrap-lib] \u{1F4C4} Result length:",i.length),console.log("[app-bootstrap-lib] \u{1F50D} Contains AppBootstrap.js:",i.includes("AppBootstrap.js")),i},generateBundle(s,i){n=L(i,o,t.assetPrefix);let r={...n,buildInfo:{...n.buildInfo,appName:t.appName,compressionEnabled:t.enableGzip,plugin:"pwa-bootstrap-kit"}};this.emitFile({type:"asset",fileName:"asset-manifest.js",source:`window.ASSET_MANIFEST = ${JSON.stringify(r,null,2)};`});let a=u(r,t);this.emitFile({type:"asset",fileName:t.bootstrapFileName,source:a}),t.debugMode&&(console.log(`[pwa-bootstrap-kit] \u2705 Generated ${t.bootstrapFileName}`),console.log(`[pwa-bootstrap-kit] \u{1F4E6} Assets: ${Object.keys(n.js).length} JS, ${Object.keys(n.css).length} CSS`));}}}function F(e={}){return [N(e)]}function N(e){let n,t={enableGzip:false,debugMode:false,appName:"Application",loadingTheme:"gradient",customTheme:"",assetPrefix:"",bootstrapFileName:"AppBootstrap.js",...e};return {name:"enhanced-pwa-bootstrap",config(o){o.build||(o.build={}),o.build.cssCodeSplit=true,o.build.rollupOptions||(o.build.rollupOptions={}),o.build.rollupOptions.output||(o.build.rollupOptions.output={});let s=o.build.rollupOptions.output;return s.entryFileNames="[name].js",s.chunkFileNames="[name].js",s.assetFileNames=i=>{if(!i.name)return "[name].[ext]";let r=i.name.split("."),a=r[r.length-1];return /\.(css)$/.test(i.name)?`assets/[name].${a}`:"[name].[ext]"},t.debugMode&&(console.log("[enhanced-pwa-bootstrap] App name:",t.appName),console.log("[enhanced-pwa-bootstrap] Theme:",t.loadingTheme)),o},transformIndexHtml(o){console.log("[enhanced-pwa-bootstrap] \u{1F50D} Transforming index.html...");let s=o;return s.includes("AppBootstrap.js")||(s=s.replace("</head>",`  <script src="/${t.bootstrapFileName}"><\/script>
  </head>`)),console.log("[enhanced-pwa-bootstrap] \u2705 HTML transformation complete"),s},generateBundle(o,s){n=R(s,t.assetPrefix);let i=u(n,t);s[t.bootstrapFileName]={type:"chunk",fileName:t.bootstrapFileName,code:i,isEntry:false};let r=I(n,t,e);s["asset-manifest.js"]={type:"chunk",fileName:"asset-manifest.js",code:`window.__ASSET_MANIFEST__ = ${JSON.stringify(r,null,2)};`,isEntry:false};let a=e;if(a.generateUnifiedManifest){let l=_(r,a);s["unified-manifest.json"]={type:"asset",fileName:"unified-manifest.json",source:JSON.stringify(l,null,2)};}console.log("[enhanced-pwa-bootstrap] \u2705 Bundle generation complete");}}}function I(e,n,t){return {...e,buildInfo:{...e.buildInfo,appName:n.appName,compressionEnabled:n.enableGzip,plugin:"enhanced-pwa-bootstrap",spaHandlerCompatible:true,timestamp:Date.now()},spaHandler:{rootPath:"/",fallbackFile:"index.html",enableCompression:n.enableGzip,enableCaching:true,cacheMaxAge:86400,systemFiles:["AppBootstrap.js","asset-manifest.js","unified-manifest.json"]},pwa:{enabled:t.manifestIntegration?.includePWA||false,manifestFile:"manifest.webmanifest",serviceWorkerFile:"sw.js",workboxFile:"workbox-*.js"}}}function _(e,n){let t=[];return Object.keys(e.js).forEach(o=>{t.push({url:e.js[o],revision:null});}),Object.keys(e.css).forEach(o=>{t.push({url:e.css[o],revision:null});}),t.push({url:"/AppBootstrap.js",revision:null},{url:"/asset-manifest.js",revision:null},{url:"/unified-manifest.json",revision:null}),n.manifestIntegration?.includePWA&&t.push({url:"/manifest.webmanifest",revision:null},{url:"/sw.js",revision:null}),n.manifestIntegration?.customEntries&&t.push(...n.manifestIntegration.customEntries),{version:"1.0.0",timestamp:Date.now(),entries:t,metadata:{totalFiles:t.length,spaHandlerCompatible:true,pwaEnabled:n.manifestIntegration?.includePWA||false}}}function R(e,n=""){let t={},o={},s=0;for(let[i,r]of Object.entries(e)){let a=r,l=n?`${n}/${i}`:`/${i}`;i.endsWith(".js")?(t[i]=l,s+=a.code?.length||0):i.endsWith(".css")&&(o[i]=l,s+=a.source?.length||0);}return {js:t,css:o,loadingSequence:{js:Object.keys(t),css:Object.keys(o)},totalOriginalSize:s,buildInfo:{timestamp:Date.now(),version:"1.2.0",appName:"Enhanced PWA App",compressionEnabled:false,chunksGenerated:Object.keys(t).length,plugin:"enhanced-pwa-bootstrap"}}}function p(){return window.ASSET_MANIFEST||null}function A(){return window.APP_BOOTSTRAP_LOADING_STATE||null}function m(){return window.APP_BOOTSTRAP_READY===true}function S(){return p()?.spaHandler||null}function y(){return p()?.pwa||null}function P(){return p()?.buildInfo||null}function x(){let e=p();return {enabled:e?.buildInfo.compressionEnabled||false,spaHandlerEnabled:e?.spaHandler.enableCompression||false}}function h(){return p()?.spaHandler.systemFiles||[]}function T(e){return h().includes(e)}function E(){let e=p();return {js:e?.js||{},css:e?.css||{},loadingSequence:e?.loadingSequence||{js:[],css:[]}}}function C(){let e=p();return {compatible:e?.buildInfo.spaHandlerCompatible||false,rootPath:e?.spaHandler.rootPath||"/",fallbackFile:e?.spaHandler.fallbackFile||"index.html"}}function w(){let e=p();return {enabled:e?.spaHandler.enableCaching||false,maxAge:e?.spaHandler.cacheMaxAge||86400}}function O(){window.APP_BOOTSTRAP_EVENTS&&window.APP_BOOTSTRAP_EVENTS.emit("reload:requested",{timestamp:Date.now()});}async function k(){try{let e=await fetch("/unified-manifest.json");if(e.ok)return await e.json()}catch(e){console.warn("Failed to fetch unified manifest:",e);}return null}function b(e,n){window.APP_BOOTSTRAP_EVENTS&&window.APP_BOOTSTRAP_EVENTS.on(e,n);}function H(e){b("loading:progress",e);}function v(e){b("loading:complete",e);}function W(e){m()?e():v(e);}function $(){return p()}function D(){return A()}function z(){return m()}function q(){return S()}function G(){return y()}function U(){return O}function J(){return P()}function V(){return x()}function Y(){return h()}function K(){return T}function Q(){return E()}function X(){return k()}function Z(){return C()}function ee(){return w()}var g=class{constructor(n={}){this.config={cacheName:"app-bootstrap-v1",appVersion:"1.0.0",enableServiceWorker:true,loadingScreen:{theme:"gradient"},...n},this.loadingElement=null;}async init(){console.log("App Cache Manager initializing...");let n=document.getElementById("loading-screen");n?this.loadingElement=n:this.setupLoadingScreen(),await this.loadApp();}setupLoadingScreen(){let n=this.config.loadingScreen?.theme||"gradient",o=this.config.loadingScreen?.customHTML||this.getDefaultLoadingHTML(n);document.body.insertAdjacentHTML("afterbegin",o),this.loadingElement=document.getElementById("loading-screen");}getDefaultLoadingHTML(n){return `
      <div id="loading-screen" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      z-index: 9999;
     ${n==="gradient"?"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);":"background: #2c3e50;"}">
        <div style="
          width: 40px;
          height: 40px;
          border: 4px solid rgba(255, 255, 255, 0.3);
          border-top: 4px solid white;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin-bottom: 20px;
        "></div>
        <p id="loading-text">Loading Application...</p>
        <style>
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      </div>
    `}updateLoadingText(n){let t=document.getElementById("loading-text");t&&(t.textContent=n);}async loadApp(){this.updateLoadingText("Loading application...");let n=()=>{let o=document.getElementById("root");return o&&o.children.length>0&&o.querySelector(".app, .home-page, .system-config-page, .video-player-page")?(console.log("[CacheManager] App content detected, hiding loading screen"),this.hideLoadingScreen(),true):false};if(n())return;let t=setInterval(()=>{n()&&clearInterval(t);},100);setTimeout(()=>{clearInterval(t),console.log("[CacheManager] Fallback timeout, hiding loading screen"),this.hideLoadingScreen();},3e3);}hideLoadingScreen(){this.loadingElement&&(this.loadingElement.style.opacity="0",this.loadingElement.style.transition="opacity 0.3s ease-out",setTimeout(()=>{this.loadingElement&&this.loadingElement.parentNode&&this.loadingElement.parentNode.removeChild(this.loadingElement);},300));}showError(n){this.loadingElement&&(this.loadingElement.innerHTML=`
        <div style="text-align: center;">
          <h3>Error</h3>
          <p>${n}</p>
          <button onclick="location.reload()" style="
            background: white;
            color: #667eea;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
          ">Retry</button>
        </div>
      `);}retry(){location.reload();}};function te(e){let n=new g(e);return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{n.init();}):n.init(),n}export{g as AppCacheManager,f as appBootstrapPlugin,F as enhancedPWABootstrapPlugin,p as getAssetManifest,E as getAssetUrls,P as getBuildInfo,w as getCacheConfig,x as getCompressionStatus,A as getLoadingState,y as getPWAConfig,C as getSPAHandlerCompatibility,S as getSPAHandlerConfig,h as getSystemFiles,k as getUnifiedManifest,te as initializeCacheManager,m as isAppReady,T as isSystemFile,W as onAppReady,b as onBootstrapEvent,v as onLoadingComplete,H as onLoadingProgress,O as triggerAssetReload,z as useAppReady,$ as useAssetManifest,U as useAssetReload,Q as useAssetUrls,J as useBuildInfo,ee as useCacheConfig,V as useCompressionStatus,K as useIsSystemFile,D as useLoadingState,G as usePWAConfig,Z as useSPAHandlerCompatibility,q as useSPAHandlerConfig,Y as useSystemFiles,X as useUnifiedManifest,f as vitePlugin};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map