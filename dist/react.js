'use strict';var react=require('react');var y=class{constructor(){this.listeners={};}on(e,t){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t),()=>{this.listeners[e]=this.listeners[e].filter(s=>s!==t);}}emit(e,t){this.listeners[e]&&this.listeners[e].forEach(s=>s(t));}},p=new y;function h(){return window.ASSET_MANIFEST||null}function k(){return window.APP_BOOTSTRAP_READY===true}function I(){return window.APP_BOOTSTRAP_LOADING_STATE||null}function D(n={}){let[e,t]=react.useState({isLoaded:false,isLoading:false,progress:0,currentChunk:"",loadedChunks:[],totalChunks:0,error:null,startTime:Date.now()}),[s,g]=react.useState(null),[f,m]=react.useState(null),l=react.useRef(false);react.useEffect(()=>{let r=I(),o=h();r&&t(r),o&&g(o),k()&&(l.current=true,t(d=>({...d,isLoaded:true,isLoading:false,progress:100})));},[]),react.useEffect(()=>{let r=p.on("loading:start",a=>{t(i=>({...i,isLoading:true,isLoaded:false,startTime:Date.now(),error:null})),m(null);}),o=p.on("loading:progress",a=>{t(i=>({...i,progress:a.data?.progress||i.progress}));}),d=p.on("loading:complete",a=>{l.current=true,t(i=>({...i,isLoaded:true,isLoading:false,progress:100,endTime:Date.now(),duration:Date.now()-i.startTime}));}),u=p.on("loading:error",a=>{let i=a.data?.error||"Unknown loading error";m(i),t(B=>({...B,isLoading:false,error:i}));}),b=p.on("manifest:loaded",a=>{g(a.data?.manifest);});return ()=>{r(),o(),d(),u(),b();}},[]),react.useEffect(()=>{if(s||!n.enableDebug)return;let r=setInterval(()=>{let o=h();o&&(g(o),clearInterval(r));},100);return ()=>clearInterval(r)},[s,n.enableDebug]),react.useEffect(()=>{if(l.current)return;let r=()=>{let u=document.getElementById("root");return u&&u.children.length>0&&u.querySelector(".app, .home-page, .system-config-page, .video-player-page")?(console.log("[useAppBootstrap] Development mode: App content detected, marking as ready"),l.current=true,t(a=>({...a,isLoaded:true,isLoading:false,progress:100,endTime:Date.now(),duration:Date.now()-a.startTime})),true):false};if(r())return;let o=setInterval(()=>{r()&&clearInterval(o);},100),d=setTimeout(()=>{clearInterval(o),l.current||(console.log("[useAppBootstrap] Development mode: Fallback timeout, marking as ready"),l.current=true,t(u=>({...u,isLoaded:true,isLoading:false,progress:100,endTime:Date.now(),duration:Date.now()-u.startTime})));},3e3);return ()=>{clearInterval(o),clearTimeout(d);}},[]);let T=react.useCallback(()=>{m(null),t(r=>({...r,error:null,isLoading:true,isLoaded:false,startTime:Date.now()})),p.emit("loading:retry",{timestamp:Date.now()});},[]),w=react.useCallback(r=>s&&s.js[r]?100:0,[s]),S=react.useCallback(()=>e.progress,[e.progress]);return react.useEffect(()=>{n.enableDebug&&(console.log("[useAppBootstrap] Loading state:",e),console.log("[useAppBootstrap] Asset manifest:",s),console.log("[useAppBootstrap] Error:",f));},[e,s,f,n.enableDebug]),{loadingState:e,assetManifest:s,isReady:l.current,error:f,retry:T,getChunkProgress:w,getOverallProgress:S}}function E(){let{loadingState:n,isReady:e,error:t}=D();return {isReady:e,isLoading:n.isLoading,isLoaded:n.isLoaded,progress:n.progress,error:t,currentChunk:n.currentChunk}}function v(n){return D(n)}exports.appBootstrapEvents=p;exports.useAppBootstrap=D;exports.useAppBootstrapStatus=E;exports.useAppBootstrapWithConfig=v;//# sourceMappingURL=react.js.map
//# sourceMappingURL=react.js.map